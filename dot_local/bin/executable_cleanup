#!/bin/bash
# =============================================================================
# Clean up system caches and cruft
# Run: cleanup
# =============================================================================
set -e

echo "==> Cleaning Homebrew cache..."
brew cleanup -s
brew autoremove

echo ""
echo "==> Cleaning npm cache..."
npm cache clean --force 2>/dev/null || true
pnpm store prune 2>/dev/null || true

echo ""
echo "==> Cleaning Docker..."
if command -v docker &>/dev/null && docker info &>/dev/null; then
    docker system prune -f
fi

echo ""
echo "==> Cleaning Xcode derived data..."
rm -rf ~/Library/Developer/Xcode/DerivedData/* 2>/dev/null || true

echo ""
echo "==> Cleaning general caches..."
rm -rf ~/Library/Caches/com.apple.dt.Xcode 2>/dev/null || true
rm -rf ~/.gradle/caches 2>/dev/null || true

echo ""
echo "==> Emptying trash..."
rm -rf ~/.Trash/* 2>/dev/null || true

echo ""
echo "==> Done! Freed space:"
df -h / | tail -1 | awk '{print "  " $4 " available"}'
